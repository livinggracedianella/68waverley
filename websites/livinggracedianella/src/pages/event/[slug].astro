---
//import BaseLayout from "../../layout/BaseLayout.astro"
import Layout from '../../layouts/Layout.astro'
import SingleEventItem from '../../components/SingleEventItem.astro'

export async function getStaticPaths() {
  const { data: events } = await fetch(
    `${
      import.meta.env.STRAPI_HOST
    }/api/events?populate[providers][populate][0]=Portrait`
  ).then((res) => res.json())
  return events.map((event) => ({ params: { slug: event.attributes.slug } }))
}

const { slug } = Astro.params
const { data: eventItem } = await fetch(
  `${
    import.meta.env.STRAPI_HOST
  }/api/events?filters[slug][$eq]=${slug}&populate[providers][populate][0]=Portrait`
).then((x) => x.json())
// console.log(eventItem);
---

<Layout title={eventItem[0]?.title}>
  <SingleEventItem event={eventItem[0]} />
</Layout>
