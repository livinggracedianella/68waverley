---
let { title, overview, profiles } = Astro.props
import {
  fetchPopulate,
  ProfileCard,
  Grid,
  GridFeatureCard,
} from '@rkn/page-components'
if (!profiles?.data?.[0]) {
  profiles = await fetchPopulate('/api/profiles', ['portrait'])
}
let length = profiles.data.length
profiles.data.forEach((profile) => {
  if (profile.attributes.slug == Astro.params.page) {
    length -= 1
  }
})
---

<Grid>
  <GridFeatureCard
    length={length}
    title={title}
    overview={overview}
    href="/about-us#our-people"
  />
  {
    profiles.data.map((profile) => {
      let bio = profile.attributes.bio
      if (profile.attributes.slug === Astro.params.page) {
        return
      }
      return <ProfileCard profile={profile} />
    })
  }
</Grid>
